To **take payments with Stripe** securely for your small business **Moonlit Petals**, you should use **Stripe Checkout**‚ÄîStripe‚Äôs pre-built, hosted payment page. It‚Äôs the easiest and most secure way to accept payments without handling sensitive card data yourself.

Here‚Äôs a step-by-step guide tailored to your **React + Tailwind** site:

---

### ‚úÖ Step 1: Set Up a Backend (Required)
Stripe **requires a backend** to create a secure **Checkout Session**. Since your site is hosted on **Vercel**, you can use a **Vercel Serverless Function**.

#### Create: `pages/api/create-checkout-session.js` (or `app/api/...` if using App Router)

```js
// pages/api/create-checkout-session.js
import Stripe from 'stripe';

const stripe = new Stripe(process.env.STRIPE_SECRET_KEY);

export default async function handler(req, res) {
  if (req.method !== 'POST') {
    return res.status(405).json({ error: 'Method not allowed' });
  }

  const { priceId, successUrl, cancelUrl } = req.body;

  try {
    const session = await stripe.checkout.sessions.create({
      mode: 'payment',
      line_items: [{ price: priceId, quantity: 1 }],
      success_url: successUrl,
      cancel_url: cancelUrl,
      billing_address_collection: 'required',
    });

    res.status(200).json({ sessionId: session.id });
  } catch (err) {
    res.status(500).json({ error: err.message });
  }
}
```

> üîë **Add your secret key** in Vercel environment variables:
> - Key: `STRIPE_SECRET_KEY`
> - Value: `sk_live_...` (from your [Stripe Dashboard](https://dashboard.stripe.com/apikeys))

---

### ‚úÖ Step 2: Create Products & Prices in Stripe Dashboard
1. Go to [Stripe Dashboard ‚Üí Products](https://dashboard.stripe.com/products)
2. Click **+ Add product**
3. Fill in name (e.g., "Personalized Bouquet"), description, and price ($50)
4. Note the **Price ID** (e.g., `price_1NxYzABC123...`)

---

### ‚úÖ Step 3: Update Your Product Data
Add `priceId` to each product in your React app:

```js
const products = [
  {
    id: "personalized_bouquets",
    name: "Personalized Bouquets",
    price: 50,
    priceId: "price_1NxYzABC123...", // ‚Üê Add this
    description: "...",
    category: "Bouquets",
    imagePlaceholder: "personalized_bouquets"
  },
  // ... other products
];
```

> üí° For items not yet set up in Stripe, omit `priceId` and keep the WhatsApp button as fallback.

---

### ‚úÖ Step 4: Add Stripe.js & Update ProductCard
Add this **before your React script** in HTML:

```html
<script src="https://js.stripe.com/v3/"></script>
```

Then update your `ProductCard` component:

```jsx
function ProductCard({ product, allImages }) {
  const handleCheckout = async () => {
    // Fallback to WhatsApp if no Stripe price
    if (!product.priceId) {
      window.open(
        `https://wa.me/16093791145?text=${encodeURIComponent(
          `Hi! I‚Äôd like to order: ${product.name} ($${product.price})`
        )}`,
        '_blank'
      );
      return;
    }

    // Call your backend to create a Checkout Session
    const response = await fetch('/api/create-checkout-session', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        priceId: product.priceId,
        successUrl: `${window.location.origin}/success`,
        cancelUrl: `${window.location.origin}#services`,
      }),
    });

    const { sessionId } = await response.json();

    // Redirect to Stripe Checkout
    const stripe = Stripe('pk_live_51SFMunRW4qIwWPIwoVHw2MRDqfzhdPfRSWfu5bCpgrupt98pJTBiFYchY2jiyksA4JHMiDHp1kS4x1MseC0Ia41v@0BkSkibF1');
    await stripe.redirectToCheckout({ sessionId });
  };

  // ... rest of your JSX
  return (
    <div className="...">
      {/* ... */}
      <button
        onClick={handleCheckout}
        className="block w-full bg-mp-purple text-white py-3 rounded-lg font-medium hover:bg-mp-lilac"
      >
        {product.priceId ? 'Pay Securely' : 'Order on WhatsApp'}
      </button>
    </div>
  );
}
```

---

### ‚úÖ Step 5: Create a Success Page
Create a simple page at `/success` to thank customers (e.g., `pages/success.js`):

```jsx
// pages/success.js
export default function Success() {
  return (
    <div className="min-h-screen flex items-center justify-center bg-mp-bg">
      <div className="text-center p-8 bg-white rounded-2xl shadow-lg max-w-md">
        <h1 className="text-3xl font-bold text-mp-text mb-4">Thank You!</h1>
        <p className="text-lg text-mp-purple">
          Your order has been received. We‚Äôll contact you soon to confirm details.
        </p>
        <a href="/" className="mt-6 inline-block text-mp-purple font-medium hover:underline">
          ‚Üê Back to Home
        </a>
      </div>
    </div>
  );
}
```

---

### ‚ö†Ô∏è Critical Security Notes
- **Never put your `sk_live_...` key in frontend code** ‚Äî only in backend (Vercel env vars).
- **Always create Checkout Sessions server-side** ‚Äî never trust the client to set prices.
- Use **test mode first**:  
  - Public key: `pk_test_...`  
  - Secret key: `sk_test_...`  
  - Test card: `4242 4242 4242 4242`

---

### üéØ Summary
| Step | Action |
|------|--------|
| 1 | Add Vercel API route to create Checkout Session |
| 2 | Create Products/Prices in Stripe Dashboard |
| 3 | Add `priceId` to your product data |
| 4 | Replace "Order Now" with Stripe Checkout button |
| 5 | Create `/success` page |

Once done, customers can **pay securely** without leaving your brand experience.

Would you like me to generate the **full updated React component** with these changes?
