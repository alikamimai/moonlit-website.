You're currently using **React via CDN + Babel in the browser**, which is fine for prototyping but **not suitable for integrating Stripe securely**. Stripe requires a **server-side component** to handle payment confirmation and avoid exposing sensitive logic or keys.

However, you **can** use **Stripe Checkout** (a redirect-based hosted payment page) safely **with only frontend code**, as long as you **generate a Checkout Session ID from your own backend**. But since your current setup has **no backend**, you‚Äôll need to add one.

But first‚Äî**critical security issue**:

> ‚ùå **Never use your live Stripe secret key in frontend code.**  
> ‚úÖ Your **public key (`pk_live_...`)** is safe to use in frontend‚Äîbut **only for initializing Stripe.js**.

---

## ‚úÖ Recommended Approach: Stripe Checkout (Hosted)

Stripe Checkout is the **safest and easiest** way to accept payments without handling cards directly. It redirects the user to a secure Stripe-hosted page.

### üîß What You Need to Change

### 1. **Add a Backend (Even a Simple One)**
Since you‚Äôre on Vercel (`moonlit-website-m968.vercel.app`), you can add a **Vercel Serverless Function**.

Create: `api/create-checkout-session.js`

```js
// api/create-checkout-session.js
import Stripe from 'stripe';

const stripe = new Stripe(process.env.STRIPE_SECRET_KEY);

export default async function handler(req, res) {
  if (req.method !== 'POST') {
    return res.status(405).json({ error: 'Method not allowed' });
  }

  const { priceId, quantity = 1, successUrl, cancelUrl } = req.body;

  try {
    const session = await stripe.checkout.sessions.create({
      mode: 'payment',
      line_items: [{ price: priceId, quantity }],
      success_url: successUrl,
      cancel_url: cancelUrl,
      automatic_tax: { enabled: true },
      billing_address_collection: 'required',
    });

    res.status(200).json({ sessionId: session.id });
  } catch (err) {
    res.status(500).json({ error: err.message });
  }
}
```

> üîë You must set `STRIPE_SECRET_KEY` in your Vercel environment variables (e.g., `sk_live_...`).

### 2. **Create Stripe Products & Prices in Dashboard**
Go to [Stripe Dashboard ‚Üí Products](https://dashboard.stripe.com/products) and create:
- Product: "Personalized Bouquet"
- Price: $50 (recurring or one-time)

Note the **Price ID** (e.g., `price_123...`).

Add a `priceId` field to your `products` array:

```js
const products = [
  {
    id: "personalized_bouquets",
    name: "Personalized Bouquets",
    price: 50,
    priceId: "price_123...", // ‚Üê ADD THIS
    description: "...",
    category: "Bouquets",
    imagePlaceholder: "personalized_bouquets"
  },
  // ... others
];
```

### 3. **Update ProductCard to Use Stripe Checkout**

Replace the WhatsApp "Order Now" button with a **Stripe-powered button**:

```jsx
// Inside ProductCard component
import { loadStripe } from '@stripe/stripe-js';

// Load Stripe outside component to avoid re-creating
const stripePromise = loadStripe('pk_live_51SFMunRW4qIwWPIwoVHw2MRDqfzhdPfRSWfu5bCpgrupt98pJTBiFYchY2jiyksA4JHMiDHp1kS4x1MseC0Ia41v@0BkSkibF1');

function ProductCard({ product, allImages }) {
  const handleCheckout = async () => {
    if (!product.priceId) {
      alert('This product is not available for online payment yet. Please contact via WhatsApp.');
      return;
    }

    const stripe = await stripePromise;
    const response = await fetch('/api/create-checkout-session', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        priceId: product.priceId,
        successUrl: `${window.location.origin}/success`,
        cancelUrl: `${window.location.origin}/#services`
      })
    });

    const { sessionId } = await response.json();
    const { error } = await stripe.redirectToCheckout({ sessionId });
    if (error) console.error('Stripe error:', error);
  };

  // ... rest of component

  return (
    <div className="bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
      {/* ... image, title, price */}
      <button
        onClick={handleCheckout}
        className="block w-full text-center bg-mp-purple text-white py-3 rounded-lg font-medium hover:bg-mp-lilac transition-colors"
      >
        Pay Now
      </button>
    </div>
  );
}
```

### 4. **Add Stripe.js via CDN**
Since you're using CDN React, add this **before your Babel script**:

```html
<script src="https://js.stripe.com/v3/"></script>
```

And replace `import { loadStripe }` with:

```js
const stripePromise = Stripe('pk_live_51SFMunRW4qIwWPIwoVHw2MRDqfzhdPfRSWfu5bCpgrupt98pJTBiFYchY2jiyksA4JHMiDHp1kS4x1MseC0Ia41v@0BkSkibF1');
```

> ‚úÖ **Do NOT use `@stripe/stripe-js` via npm**‚Äîyou‚Äôre not bundling.

So update your `ProductCard` like this:

```jsx
function ProductCard({ product, allImages }) {
  const handleCheckout = async () => {
    if (!product.priceId) {
      // Fallback to WhatsApp
      window.open(`https://wa.me/16093791145?text=${encodeURIComponent(
        `Hi! I‚Äôd like to order: ${product.name} (Starting from $${product.price}). My event date is: ____`
      )}`, '_blank');
      return;
    }

    const response = await fetch('/api/create-checkout-session', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        priceId: product.priceId,
        successUrl: `${window.location.origin}/success`,
        cancelUrl: `${window.location.origin}/#services`
      })
    });

    const { sessionId } = await response.json();
    const stripe = Stripe('pk_live_51SFMunRW4qIwWPIwoVHw2MRDqfzhdPfRSWfu5bCpgrupt98pJTBiFYchY2jiyksA4JHMiDHp1kS4x1MseC0Ia41v@0BkSkibF1');
    const { error } = await stripe.redirectToCheckout({ sessionId });
    if (error) console.error('Stripe error:', error);
  };

  // ... render
}
```

### 5. **Create Success Page**
Add a simple `/success` route (e.g., another HTML page or section) to thank users.

---

## ‚ö†Ô∏è Common Pitfalls to Avoid

| Mistake | Why It‚Äôs Bad | Fix |
|-------|-------------|-----|
| Using secret key in frontend | Exposes your account to fraud | Only use **public key** in frontend; secret key **only in backend** |
| Handling raw card numbers | PCI compliance nightmare | Use **Stripe Checkout** or **Elements** (but Elements still needs backend) |
| No backend session creation | Can‚Äôt securely confirm payment | Always create session server-side |
| Hardcoding prices in frontend | User can manipulate price | Prices must come from **Stripe Price IDs** |
| Not validating webhook events | Can‚Äôt fulfill orders securely | Later, add webhook to mark orders as paid |

---

## üöÄ Summary of Changes

1. ‚úÖ **Keep your public key** in frontend ‚Äî it‚Äôs safe.
2. üö´ **Never put secret key in HTML/JS**.
3. ‚ûï **Add a Vercel serverless function** (`/api/create-checkout-session`).
4. ‚ûï **Add Price IDs** to your products in Stripe Dashboard.
5. üîÑ **Replace WhatsApp button** with Stripe Checkout button (with WhatsApp fallback for non-setup items).
6. üì• **Add `<script src="https://js.stripe.com/v3/"></script>`** to HTML.
7. üéâ Test in **test mode** first (`pk_test_...`, `sk_test_...`).

---

Would you like me to generate the **full updated HTML file** with these changes (including the fallback and Stripe integration)?
